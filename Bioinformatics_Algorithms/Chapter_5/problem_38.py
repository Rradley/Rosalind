import sys
sys.setrecursionlimit(5000)
from problem_39 import LCSbacktrack

def outputLCS(backtrack, aminostr1, aminostr2, i, j, al_str1, al_str2):

    
    if i < 0 and j < 0:
        return (al_str1[::-1], al_str2[::-1])
    
    if i < 0:
        nal_str1 = al_str1 + '-'
        nal_str2 = al_str2 + aminostr2[j]
        return outputLCS(backtrack,aminostr1,aminostr2,i,j-1, nal_str1, nal_str2)

    if j < 0:
        nal_str1 = al_str1 + aminostr1[i]
        nal_str2 = al_str2 + '-'
        return outputLCS(backtrack,aminostr1,aminostr2,i-1,j, nal_str1, nal_str2)

    if backtrack[i][j] == 'u':
        nal_str1 = al_str1 + aminostr1[i]
        nal_str2 = al_str2 + '-'
        return outputLCS(backtrack,aminostr1,aminostr2,i-1,j, nal_str1, nal_str2)
    elif backtrack[i][j] == 'l':
        nal_str1 = al_str1 + '-'
        nal_str2 = al_str2 + aminostr2[j]
        return outputLCS(backtrack,aminostr1,aminostr2,i,j-1, nal_str1, nal_str2)
    elif backtrack[i][j] == 'd':
        nal_str1 = al_str1 + aminostr1[i]
        nal_str2 = al_str2 + aminostr2[j]
        return outputLCS(backtrack,aminostr1,aminostr2,i-1,j-1, nal_str1, nal_str2)


def scorematrix(path):
    file = open(path, 'r')
    line = file.readline()

    SM = []
    line = file.readline().strip('\n')
    while line != "":
        line = [int(i) for i in line.split(' ')[1:] if i != '']
        SM.append(line)
        line = file.readline().strip('\n')

    return SM

def globalAlignment(aminostr1,aminostr2):

    aminos = {'A':  0, 'C':  1, 'D':  2, 'E':  3, 'F':  4, 'G':  5, 'H':  6, 'I':  7, 'K':  8, 'L':  9, 'M': 10,
     'N': 11, 'P': 12, 'Q': 13, 'R': 14, 'S': 15, 'T': 16,'V': 17, 'W': 18, 'Y': 19}

    SM = scorematrix('BLOSUM62.txt')
    pen = 5

    len_amino1 = len(aminostr1)
    len_amino2 = len(aminostr2)

    s, backtrack = LCSbacktrack(aminostr1, aminostr2, aminos, SM, pen, local=False)
    al_str1, al_str2 = outputLCS(backtrack, aminostr1, aminostr2, len_amino1-1, len_amino2-1, "", "") 

    return (s[len_amino1][len_amino2], al_str1, al_str2)


if __name__ == "__main__":
    
    file = open('../dataSets/rosalind_ba5e.txt', 'r')

    aminostr1 = file.readline().rstrip('\n')
    aminostr2 = file.readline().rstrip('\n')


    aminostr1 = 'LVDCQLDIIMEEGVTQCMCNHLMDKRGIDTEFCLMYHAGPWYQTMFKCCDAWPRTVVYSGVSYITNMVIKLAAILVMDYEYAGFVTPKSSNLTYMENVHWTWADDQGWHIEYLQGVVSQMQWYQRDYQGGGLCTFFRRIEQMIRVYNAKKWAQMWNYSEGTFGHVWVDVQMYRYNLADHVANPVTNMLNQHAFVFITTYCLVCDTLHIMYARLESDMQHSIIVKHGWPINADTGSCLTFWRIDWWVMCWKMVGKQPSAIGISYWNMCHIATNFTSRLDEVYLGHSWHCPHRASLETYANFRAEIQMLMLFEIGFPPRNQHNHLVPHYVVPFEFDYYICQQFHYKWALLRNPSNLDKLQFRFTWAQIWENRWGSIHELECPCISWLKQNEDKWEWMMKPVYVSIVCVDACPARKDYACADAPSMNWTIKEFNARAVKIKFVCIHCAQIRFLIERWAWRSIDNGLNVRTQAYGARTTNHGIDGHYRLQDAFVDIDVRNWCHWLMMEPPDGTFERQRSGEANETMTPPWIKQFMPMFLWIHFANIMLLQRTLHTMVACAGIGTFMRYWHAYFKEENTYRAFSDDVQNPFSFQPKTDFYQNEAVPRMCLCYCSTRVLRWECPKCIMMDSHCTIDYFPRTSVCGYPDMQSQIEINSWRDHVELHGWIILNMQFVWVIFVDWKQWKVQKLDTCAWRECFKFIEPWHRAMLCTCLMKFWARGAIIQPNWKMGRDEPSWLYNLMTFNSEEEHNVMFCRWACHFYVPCRRSHNSYQSLDWQDWCLWAARHLHQDNAADCQIKMLSMVWDLLPVCGDSCIWEDMIPCGHVIDIFEIVTAQIRSPNPLPDRQCFSYCYDRPSSTGQNKHLWPSYNRECMIQAYMSIFECCLDTFWWNCVPHREMAWFVNWCVGLSARIDCWIYLDKLHWPCGLPINGVYQFAKRYWEPTTIITCDFWRAMAYWEVWRISSPNSSNMMQMDASWYIPRMIDRDHRALLLYVSHQWRYWHCIHQDGLRVVPMNLCTWKMQWFVARMMYPEMKTPAFNFHDTSYGHNVNYKYPPAFSFFRNVTVTPINRDMSYTAKHPDHFTFDLAWEAWDVKYTHMHRCYETHRICITLPQSWIVPPTSVPSQFRCRDGNEFPTHQPGKKRCWVSGPGQSMIGYHNPQDIGPRRRWSNWLPQIEWVKANSTTPEEHPQQWSVPGEELTAIISAHCMHCNRFHWLSSYDEGIDCKGNEIKVHMHKFQFTMTLWVDRECMCWAHCEIKPGMRPRGWETGCFHNHCIWYRFVAKDAEECWYTGHCSGDGAEIGYMMAFEYDMCLTAKMRCQGLWDVAAIFVANEYGDEPSPDLSSSRVKECTHIWHAISENKILQEVHNIQTGLPLGTEDSPSTAISWYWHKMCQDRCRGGQPRQNSARWFLQWYNPGIMKEANHEIMFITVTFRADVWLILFWVDYKKKIGLYILFFFRRPYLWYDLVKRAFVYHSDRIQLVPNGELENTIRNWNVEQKSWNIPPRRRIMTEGEWVQDGVFWKVAKRLFVYSCGNPSDTIDCYTNHDGCIAPQGELINAIAQMFMIVRYYKYDCYMEFVIGYAFHADCADQMNKPTYRIRQMKNMSYTLFKMLWARNQCAWIRWPGHKRPWWMDLMWPFGLVWERIKREGMWTMRRTTKCDGVWVTGHLSSRLDYPWNLHGYAYSDCHWDRADTDKRVQIVVDRINAPTYIMHTGKDHKWVWRLHVCAHQRSKHAPYKCWLDARCVSTLISDPIHFDTPLAEKCMFWFCKDDKMDWDDEKLELMMPNHWIEHCSDQFAKWGKFPRRVLSRNHQDHKKYHASRPHPGFVWYSHTRIVAMYPRVLVQVSSKESPWITEGVNWDAGINMCWRTTGSNFAIWRDVELNHTTMRVHAELIGDEYANRFAWPEAKCFCHEADCRDSSGFRTHTMLAMEMKAVVCHPGISQARGMVTMRFAKYEFKNQYEKHFPCFCGPDILQCEQRNALRSIQDADEQAATDAESCHERCVRCDQRWRVYCARQIHCMAHCMMPILPLDFDPCFETDPTLRLKWQMGTDCDPEFPVRYQTDDAEHDDMIFRNQCNVMQVNGWSYAFRSTAMWCRFKFKTVEQVGHIHSVVRATTPGTESMWYLEDTWRLWLKNIYAVCIKYKFMTFWFQRKMELNMGREVDRGSIEEIWYTPVWQMRTGRGRWGTHVWLIFWVIPADGGTRDLLFCHMFGPNWIYSELIMVYMKEDMISTVQDITDVFYYYAQDTHTIGWDKTYSVECSPCRTKVNQEIDPTVLYQWTTWDYYYKIRKPRWYYHYSSVLSWCECSVFNDWPFNWELQQVFSAMMMSCRLSNFIIPYGYCGTCILWVQGTVSNDPSETGEQQYHQRFCATFRHEDFMDIGIEMSCHELLWYLHSDERFQFHTRIGRTREHHVCDIEMWHPSKDQWEPFQPRIMHFVDDMAKKVNWANNGQIWDCAWKHPSPHVPLWEGLYVPEGMAKEAYMTEWPPSAQEFMLTNGLAQMAGYMHNQDVTDYKAWTDAATHHCDDLDECLMACEQCLVYETASLMATFLDVGVYLRITGYGTSLISSYIMSTEIQQRFEHMHWFQQNKLGNGTPWPNPKHPTELKVYYAISAQLYNGLERKKFFHEHNNGIVFMCGNWDLPVAMNHPCVPVLTYTLEQPTRPQNNEYNQCFAHDDNLVHVENAYKFMCFMQYELPHEEARSPTQNPIEFFIVEKECMTPDPASCWQLNLNNRKLLTISISFSAKIESPIMCIRLIKTSGECEFPMRMCWYKHGGWKSPDRGHCRVSGFFWHGINNFSTECPQQPMAGGYVAVRFFEVYENHNEYGLETGRTLNRQGLDMAGAICHGNDSFHVCGLMHGSSNCSESRCQSTTWNAHGIKCRDYYKCVVREFCFYDENVWKQSSAATWKWPIHSANRDGNGKYDKRACNWPIFLQYNTMCGNKCQNWHLLSAWYLIRYGTDINGTKPFLPQASKENSHQFRKHYLQHHKHHPTERMHDCIYPNWMVAPDATHIVFLHCEITARNVQSCHAWTFIFQIHIEILYLFNSHVGPLETWVYYWHFLSPPQGFPIKMDWGPHRSIMRNETCAEIAVPGMCIRELIIFQSCFYALALECKCPWKNVLGKKKRWYDMIVFAVDEDPQWPNYRISKKGNTHVRIMHKNYREPTIWGCNGHHDNMMGLLNDGMTPPPEKWNSLFEPSKHVLASRDIDWECVACGGRTYAWMNYIGPAEECTRAQWWCPRSDVYTSCPSYIQCCNWDLAFQIQLYLTPCCFGKSMLRCMYTFDGKNELAICGWWQPWFTQWNREERATPTRRYPESTLQWYTHHSKVKGFPEMWSCRREMFKAAKLYFEKGIEPTQRTDKVIYDPDRVIYCMQHAPPSYILVKGKFAKKTVSKQHSLQLPHQWLYHLSCIWTQPQADGHCMYDEYKGPALALQHYPTFPWIQPASRHITSNEVKPSWYFKFIMLAYAVQCPDRNTIKQEHYDRYPCQTAGRPISENKHRWHTYIRMAFPFGKQGAILQEPNDDKGDCPSIINRAGGPRNVLLRNIFLRVFRNPISMHGRKVTDQTHDNMNADSEAWYMMQEYAGLIMTGHCEGCRIIAKWGWTAEPRHYKTYVASMNRWESLAITSYIRLLQHCGKNWEHEQQKFWKYHDWCQIKLAEKIMATKTYACSHDGCNRNFTYDRQMYWYGQIIANKCPYQFTYQSAGKWDDMLKFMNYFMYFCGHVDPPVYPRNRAWACDPPLLHDFQFNHNGGCVHSMWWHTMFVWRNQYPNTRRMAHHALNQWMQTRCWHIGLSWEWTNIKNPIPIHFVLYATRHDIMCWMLGMAHDHTDQEWPVKFWCAGSHQTCCNMGNSNPEELTNCNKDNVSARHFCYQLKQVMGIWPWSNFFQRNVAHSSMLLTNVMNEEWEFVTYAHDQQHICECWPEPKVVWTKPGQDFPKHPGWIHKPVIDLEAVKEPAFATCQVAAGNQTMTVRTTSLLQVTRGPHMGDPNWLYLQNDMMYMEIAKPREAVAHDICRCINHFKALDQWHKVQYMSCALPMTDVEVYYPRKCAYHTGALYIMSGGHWDCDNKCVLCQMATYLRWMWSHWNLLDYWVFEWFFQQFITLGGFQDFNCCDVLGGGGSVGPRCMSQMFRENKVVAWSWGACPDHFKCAWTCQVPSCPWPQWWHIIQCLIQAGLNESFHLFGTIQLDILSVLWERFREQ'
    aminostr2 = 'LVHCQLDIIMEEGVTQCMCDHNRKNYKRNMDIAARLHPMPNTEFGPWYQTMFKDIQTEAQFVCDAWFRTVVQMTPESSGVSYITNMYIKLAAKLVMKTRRHCMWYEYAGFVTPKSSDGDYMFALTYMENVHWTWADDQQWHIEQWFKWESRDYQGGGRIYWTSEQARVYNARKWALMWNYPERMKMCIMYRYNLADHRANPVTNMLNQGYWWLKNMCLVCDTQHIMYARLESDDQHSDPWQGLEFHVKHGIDSYFIKQGSCLTFWRPWWHMCWKMVGKQPSAIGISYWEMRCYVHIATNFTSDEVYCTERPKRNAGHAWHCPGTTIHHWMRASLETYAQYRAEIQMLICFPMRCIIYAWTESDYYYCPFFHWRCKWALLQFRFTWLQIWEGSIHENLCNCISWLWCSQDAPCSMQGNEKPKVQIAPLYVSIYKLTEPQFCVDACPDITRKDYECADAPSMNWTITLILEFNARAVKIPQPSYMFVHCAQIRFLPALLMEFVEKGHGSPILNTRTQAYGATGNHGIDYRLQYGQTYLFFVDDIDVRIQWVCVKWIHWLMEPTDGTSWTPANALERQVSGEANETWTPPWGKQFNRDEWNEEDPNIWCWFVLLQRTLHTMYMLVAKGNHTVLQLAGIGTFMRYWHLYFKEEMTEIRNTYRAFSDFVQNPFSFQPKTKFTTMEAVPRMCLCKDMKGLSTPKCIGIFSCVMKFAVHTSNMSHCTIDYFPRTSVCGYPDRYIFFYIHPNKMVRCQKLHGWIILQMQFGTIYWVIFRDWKQWKVQKLDTCAWRKQTPENKCFKNIEPWARAFWFTCLCCYLPRQMTSDFCFWARGARCWGSSIIHDIEYPKMECNLNSWLYNINSEEEHNVMFCRWFCHFYVRWTCRRSHNSSKDWQYWCLWAGRYMVMSWIVHLHYDVAAVHGQGFPACIGMCVDKKMLPMTMVGDLLMVCGDSRWWAFWEDMIPCGGTHVIDITEIQTATIRSPNPPIRQWFSYCYDRPSSTGQNSMIQAYMDVCCGYHTHIFECCSDCFWWNQVPHREMAGNSHYASDQFHNWCVYHVDDSLEQECNNTPRIDCWIYLQDWYINGVYQFAKSYIEILNITTIEPTTHGTCCFWRGENMAYWHPKQKVVDAPGSGVNSSWMNQGCHFAFWIGRDRRALDGHLPLYSHQWRYWHCIHQDWIHNARVLMVVPMNLCTWKDYWFVAFMMYPEMKDDIEHHSPARNFHDTSYGHRWVRHIVNYKYPIAFSKFRNVTVTPINIDLHNQSPDMSDQFVSPCAWDVKYTHMHRCYETHRCEQHWIWEQERPRHSLPQQIGWVWDVYWINKYGFDNPPVSPVRFMCTSVAHMQFRCRDGNEFPTHQPTDKIHDKKACWTVRKKPLELIHNQSMITFVVHNRWSNWVKQVEWSDEHPQQWSVPGEEIWSAPDISAFHWLSSYDEGIDCKNLNWEIKVFTMTLWVDRECYVCWAHCEIKPGMRPRGWGTGCFHNHCIWYRFPGKHAEYCWYTMFPWHCSLHFDDNALQMGDAENDMAFEYDMCVTAKMRQSVQGLWDSIMTNVGMEYGDEPSPDLSSSRVKECTRIWHARSETKILTMYIQTGLLYYCLGKLEDMRILPSTAISWYWHKMCQDRSARWQLQWRLECYNPKIMKEIVDCINHEIMFYTVTFFAEISAADVWLILFWMDYKKILFFQWYDLVKRAFVYHSRISDRLPWMRELVPNGELVNTIRHWNVEVKSWNIPPRHRSRIIHDMTEGEWVQDGVFWWVAKWQEAYYCGNPSDTIDCITNHGGCIAPQGELINAIAQMFMIVRYYVYDCYHEFVPGYAFHADCADQMNKPGYRKNSSYTLFKMLWARNQIAWIRWPGHKRPWWMAWPFGLVWECIKREGSSLYTPLMRNMDNQRSIITHYHGVWVTGHLSSRLDYPWNLHGYAYSDCHWDPADTDKRVQIVVWRINAPTYIMHTGKDHKWVWRIHVCAHQRSKHAPYKCWLDALFITCLISDPIDTPLAEKWVMFWFCKDAQQSKMDWDCEKLEKSMPNHWIEHCSDQFAKHGKFPRAVLSRDHKKYHASRPHPGFVEKNQQAYSETRIVAMYPRVLVQRSSKASVWITEGVNWINMCWQFFHMLSCHNFAIWRSRELNAELIGDMYANRFCEESFAEWPEAKCFCNEADCRDSSGVEHTNDEKDAMEMKAVVCNPGARGMNTMMQMCDEAIFAKYEFFWNQYEFYSKPVCYCEQRNALRSIQDADEQAATGAESCHERNVYCARQILCMAHILWCMMPILHHGEDPCFETNMGDDPDLEFPVRYQEEWRCPDAEHDMMIFRNQCNVMVNGWMYMFRSTAMWFKTVEQVGHIHVVVRATTPFTEVDWYLEDTWRLWLTNIYAVCIKYTFWFVERKGREVDRGHIETDMVIAVYDPVRWGTHVWLIFWSIYDGGTRDLDHENWIYEPIMVYMVGLDEDMDSTVQCIGEFECRDMHDTPMPFRFTIGWDVACYPCGTYSVEVNQEIDPTVCYYWTTWKPRSSVLSWCECHVFNDWPRFMKTAWSAQQVFCVAMMASCGNCNFWEPYGYCGWVEGTVYQQYHCFWNFRHEDFWDVYDDNYHGIISNEMFCDWERFQTGDGHHVMGESNGVSVHMTREHKVCDIEMWHPRKDQWGFAQCFQPRRCGPDQIVHMHFVYPNAKAVNWANLGCWWDCAVPLWEGLYVPEGMAKETWMLRLHSAQEFMLCSHIMIGYMSCRHMHYCENQDVTDYKAWTIAAVQDPERSWHCMDCDNCENLFQMMMACEECLVYETASLCATFLDVGVYLRITGTAYGHSLISSYIESTEIQLRFEHANWFQQEKWPNPKHPTELKVYISREQKVTIDKSLMKPYSQSMKRCLNWDLPVAMNHPCVPVLTYTLEQHENAAKELFNVCFAHDDNLVHVNNAYKNWWGLPHEEARSPTQNPIEFFIVEKECMTSVYIRKYMRFSQFVKASCWQLNLNSRKLLTISDNIHSFSAKSESSWKVFLIYHTFPMRMCWHFCSPSGCRVSGFESCDCWHGINNFSTECPQQPMAKIFFEVYENFNEYGNETGRCLKRQGLDMQGAQWCGGMHGWYEMCHWFSICSESRNQSTWTPVCHEFWYYKCVQNVWKQPNWSVESAAQKFHTSRKWPIHSAVKMNQQDGNGKYCNWPIFLQYNTMCGNKCQNWHLLSAFCAQFCYDWEINGTKKTVAREYKENSHQWRKHYLQHHKHHRHLYPHWMVAVFLHCEITYECQAVQRDKKRPQWHKTHAFHVTVIFNSHVGPEETWVYYWHVATFLAPLNWHCYPPAWGFRPSNGGFIIKMDWTFRPHFSCEHLYERIETCARIAVPGMCIRELPIFQSCRYDLALECRCPWKNVLGEKKRVLPVPAKYDYDMIVFAVDEDCCPKQQWLWVGIQLFYRHYQVRRFIAAIKWNEPSIWGCNGHGDNMAVMMMTKPPEKWNSLQEPSKHVLAVVWEFAETCVACGGRTYAEGKEKICTRAGPEIPRWWCYTSCPSYINCCNWDEHIVRYDYLVFQIQLGFSMLRCMYTFDGKNELAIEGWWREERATPTRRYPEFAYEGTLQWYTHHSKVKGIPEEPNMKLAVWSCREWHLWMLHIEMLYTCIYIEDKEKGIEPTIRTDKVIKDPDRVIYCMQHQPPSYIKFFTKKQHSLELAHQWLYHLHPKDIVCCIWTQPLCMIQVADCHCMKGFALALQHYPTFPWIKPDNSRYHDNSRHITAEYFKSIMLAYAVTIKIEHYDRYPCQTAGRPISENKHFYEAPFGKLAQTMQMMGIIQTCEKGLQPNDDDGCDMYCPMHSDWNGVMIINRAGGPRNVLLRNIVLRVFRNPYSMHGRKVQPHDNMNADSEGWYMMQEYAGLIMLGPLVVHGNGHCEGCHQVSLECWIIKWTAESMNRWESLAITSYIRLWNIHEQVVYKGPFWCQIKLAKKIMATKTYACSHDGCNRNFTSNESSKRSMRKMYWYGQIIANKCDDMLKAMNYFMYFCGHVDPPVYPRNRVTSWACDYRTRVRGWPLLHDFQFNHNLGCVHSMGDDWHTMFVWRNQIPNTRRMAHHALNRHQIGVAWSWTNIKNPIPIHFDLYATIMCKMLGMAHDHTDQEWPVKFWCAEGSHQTCCNMGNSNPEELGKHNCNCNKDNSDWSNDARHFCAQLKQVMGIWPMPMMVSHTNFFQRNVAHSSMLLTNVASRTNLNCYAHDQQVQDICKCWREPHVYGGRVRYYKGANTEAKPGWIHGKQPAFACCQVAAGNQTMCFIKLEFGDILATPHMGDPNWDLNLQNDMMYMEIAKPRERVAHDICRCINAVGGLADMDQYMSCALPMEMWCTQDVEVYYPRDCAYHTGALYIMSGGHWDCDSYGDTCSNKCVLCQMETYLAHLASWMWSQFITLGGFQDFNCQDVLQGGGNVGPSQMFGACPYYIWGMCYDHFKCAWWCQVPSCMWPQWWHIIQAGLNWSFHLFGTIQLDILSVLWERCPCPKIREQ'    

    score, al_str1, al_str2 = globalAlignment(aminostr1,aminostr2)

    print(score)
    print(al_str1)
    print(al_str2)